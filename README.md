# –£–ª—å—Ç—Ä–∞–±—ã—Å—Ç—Ä—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π HTTP-—Å–µ—Ä–≤–µ—Ä –Ω–∞ Kestrel (.NET)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–≤–µ—Ä—Ö–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∏ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ HTTP-—Å–µ—Ä–≤–µ—Ä–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ Kestrel **–±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ASP.NET Core Middleware, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –∏ DI**.

–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–∞–º–æ–º –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `System.IO.Pipelines` –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä Kestrel, —á—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏.

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–ë–µ–∑ Middleware –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ASP.NET Core**
- **–†—É—á–Ω–æ–π –ø–∞—Ä—Å–∏–Ω–≥ HTTP –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤**
- **–ù–æ–ª—å –∞–ª–ª–æ–∫–∞—Ü–∏–π –≤ "–≥–æ—Ä—è—á–µ–º" –ø—É—Ç–∏**
- **–ü—Ä–µ–¥—Å–æ–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏, –≤–∫–ª—é—á–∞—è `Date`**
- **–ö–∞—Å—Ç–æ–º–Ω—ã–π `BufferWriter` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏**

---

## üß± –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### `Program.cs`

- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Kestrel –Ω–∞ `localhost:8080`.
- –ó–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `HttpApplication<EmptyApplication>`.
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é.

### `HttpApplication<TConnection>`

–®–∞–±–ª–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π:
- –°–æ–∑–¥–∞—ë—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `TConnection`, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ `IHttpConnection`.
- –ù–∞–∑–Ω–∞—á–∞–µ—Ç `PipeReader` –∏ `PipeWriter` –∏–∑ —Å–æ–∫–µ—Ç–∞.
- –ó–∞–ø—É—Å–∫–∞–µ—Ç `ExecuteAsync()` ‚Äî –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.

### `EmptyApplication`

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `IHttpConnection`, –∫–æ—Ç–æ—Ä–∞—è:
- –ü–∞—Ä—Å–∏—Ç HTTP-–∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ `HttpParser<T>` –∏–∑ Kestrel.
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞—Ä—à—Ä—É—Ç (`/plaintext`) –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `BufferWriter` –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞.

### `DateHeader`

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π `Date`-–∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º—ã–π –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É —Å –ø–æ–º–æ—â—å—é `Timer`, —á—Ç–æ–±—ã –Ω–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å.

### `BufferWriter<T>`

–°—Ç—Ä—É–∫—Ç—É—Ä–∞-–æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ `IBufferWriter<byte>`:
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ `Span<byte>`.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∞–ª–ª–æ–∫–∞—Ü–∏–π.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é –∏ –∫–æ–º–º–∏—Ç –≤ `PipeWriter`.

### `BufferExtensions`

–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è `BufferWriter`:
- –ó–∞–ø–∏—Å—å —Å—Ç—Ä–æ–∫ –≤ UTF-8.
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∏—Å–µ–ª –≤ ASCII –±–µ–∑ `ToString()` –∏ –±–µ–∑ –∫—É—á–µ–≤—ã—Ö –∞–ª–ª–æ–∫–∞—Ü–∏–π.

---

## üåê –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å        | –û–ø–∏—Å–∞–Ω–∏–µ                                  |
|-------|-------------|--------------------------------------------|
| GET   | `/plaintext`| –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"Hello, World!"` —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏. |

---

## üöÄ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–∏—ë–º—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- ‚úÖ –ù–µ—Ç DI, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –∏ –ø—Ä–æ—á–µ–≥–æ "—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞".
- ‚úÖ –†—É—á–Ω–æ–π –ø–∞—Ä—Å–∏–Ω–≥ HTTP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ç–∏–ø–æ–≤ Kestrel.
- ‚úÖ –°–≤–æ—ë —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞–º–∏ (–±–µ–∑ `string`, `Stream`, `TextWriter`).
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ (`Date`, `Server`, `Content-Type`) –ø—Ä–µ–¥—Å–æ–±—Ä–∞–Ω—ã –æ–¥–∏–Ω —Ä–∞–∑.
- ‚úÖ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π –Ω–∞ –≥–æ—Ä—è—á–µ–º –ø—É—Ç–∏.
- ‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π `inlining` –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è JIT-–Ω–∞–≥—Ä—É–∑–∫–∏.

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- .NET 8 –∏ –≤—ã—à–µ
- –¢–æ–ª—å–∫–æ Kestrel (–Ω–∏–∫–∞–∫–∏–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –æ—Ç ASP.NET –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö API, **–Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω **–¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**. –û–Ω **–Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç**:
- –ü–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É HTTP-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

---

## ‚ùì –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç .NET –Ω–∞ —Å–∞–º–æ–º –Ω–∏–∂–Ω–µ–º —É—Ä–æ–≤–Ω–µ ‚Äî –±–µ–∑ –º–∞–≥–∏–∏ ASP.NET Core. –ê –µ—â—ë ‚Äî —á—Ç–æ–±—ã –≤—ã–∂–∞—Ç—å –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ Kestrel.